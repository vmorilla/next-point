# ZX Spectrum Next Registers

[General documentation](https://www.specnext.com/tbblue-io-port-system/)
[Sprite registers](https://wiki.specnext.dev/Sprites)

| RW  | Port | Z88DK symbol                  | Description                                                                                                                                                                                                                                                                                                                         |
| --- | ---- | ----------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| R-  | $0   | REG_MACHINE_ID                | Identifies TBBlue board type. Should always be 10 on Next                                                                                                                                                                                                                                                                           |
| R-  | $1   | REG_VERSION                   | Identifies core (FPGA image) version                                                                                                                                                                                                                                                                                                |
| RW  | $2   | REG_RESET                     | Identifies type of last reset. Can be written to force reset                                                                                                                                                                                                                                                                        |
| RW  | $3   | REG_MACHINE_TYPE              | Identifies timing and machine type                                                                                                                                                                                                                                                                                                  |
| -W  | $4   | REG_RAM_PAGE                  | In config mode, allows RAM to be mapped to ROM area                                                                                                                                                                                                                                                                                 |
| RW  | $5   | REG_PERIPHERAL_1              | Sets joystick mode, video frequency and Scandoubler                                                                                                                                                                                                                                                                                 |
| RW  | $6   | REG_PERIPHERAL_2              | Enables CPU Speed key, DivMMC, Multiface, Mouse and AY audio (see section 3.10.4, page 115)                                                                                                                                                                                                                                         |
| RW  | $7   | REG_TURBO_MODE                | Sets CPU Speed, reads actual speed                                                                                                                                                                                                                                                                                                  |
| RW  | $8   | REG_PERIPHERAL_3              | ABC/ACB Stereo, Internal Speaker, SpecDrum, Timex Video Modes, Turbo Sound Next, RAM contention and (un)lock 128k paging (see section 3.10.4, page 115)                                                                                                                                                                             |
| RW  | $9   | REG_PERIPHERAL_4              | Sets scanlines, AY mono output, sprite-id lockstep, resets DivMMC mapram and disables HDMI audio (see section 3.8.7, page 101)                                                                                                                                                                                                      |
| RW  | $0A  |                               | Mouse buttons and DPI config                                                                                                                                                                                                                                                                                                        |
| R-  | $0E  | REG_SUB_VERSION               | Identifies core (FPGA image) version (sub minor number)                                                                                                                                                                                                                                                                             |
| RW  | $10  | REG_ANTI_BRICK                | Used within the Anti-brick system                                                                                                                                                                                                                                                                                                   |
| RW  | $11  | REG_VIDEO_TIMING              | Sets video output timing variant (see section 3.3.12, page 60)                                                                                                                                                                                                                                                                      |
| RW  | $12  | REG_LAYER_2_RAM_BANK          | Sets the bank number where Layer 2 video memory begins (see section 3.6.8, page 81)                                                                                                                                                                                                                                                 |
| RW  | $13  | REG_LAYER_2_SHADOW_RAM_BANK   | Sets the bank number where the Layer 2 shadow screen begins                                                                                                                                                                                                                                                                         |
| RW  | $14  | REG_GLOBAL_TRANSPARENCY_COLOR | Sets the transparent colour for Layer 2, ULA and LoRes pixel data                                                                                                                                                                                                                                                                   |
| RW  | $15  | REG_SPRITE_LAYER_SYSTEM       | Enables/disables sprites (RSLS_SPRITES_VISIBLE), Lores Layer (RSLS_ENABLE_LORES), sprites over border (RSLS_SPRITES_OVER_BORDER) and chooses priority of sprites and Layer 2 (RSLS_LAYER_PRIORITY_SLU, RSLS_LAYER_PRIORITY_LSU, RSLS_LAYER_PRIORITY_SUL, RSLS_LAYER_PRIORITY_LUS, RSLS_LAYER_PRIORITY_USL, RSLS_LAYER_PRIORITY_ULS) |
| RW  | $16  | REG_LAYER_2_OFFSET_X          | Sets X pixel offset used for drawing Layer 2 graphics on the screen (see section 3.6.8, page 82)                                                                                                                                                                                                                                    |
| RW  | $17  | REG_LAYER_2_OFFSET_Y          | Sets Y offset used when drawing Layer 2 graphics on the screen (see section 3.6.8, page 83)                                                                                                                                                                                                                                         |
| RW  | $18  | REG_CLIP_WINDOW_LAYER_2       | Sets and reads clip-window for Layer 2 (see section 3.6.8, page 83)                                                                                                                                                                                                                                                                 |
| RW  | $19  | REG_CLIP_WINDOW_SPRITES       | Sets and reads clip-window for Sprites (see section 3.8.7, page 101)                                                                                                                                                                                                                                                                |
| RW  | $1A  | REG_CLIP_WINDOW_ULA           | Sets and reads clip-window for ULA/LoRes layer                                                                                                                                                                                                                                                                                      |
| RW  | $1B  |                               | Sets and reads clip-window for Tilemap (see section 3.7.6, page 89)                                                                                                                                                                                                                                                                 |
| RW  | $1C  | REG_CLIP_WINDOW_CONTROL       | Controls (resets) the clip-window registers indices (see section 3.6.8, page 83)                                                                                                                                                                                                                                                    |
| R-  | $1E  | REG_ACTIVE_VIDEO_LINE_H       | Holds the MSB of the raster line currently being drawn                                                                                                                                                                                                                                                                              |
| R-  | $1F  | REG_ACTIVE_VIDEO_LINE_L       | Holds the eight LSBs of the raster line currently being drawn                                                                                                                                                                                                                                                                       |
| RW  | $22  | REG_LINE_INTERRUPT_CONTROL    | Controls the timing of raster interrupts and the ULA frame interrupt (see section 3.12.4, page 125)                                                                                                                                                                                                                                 |
| RW  | $23  | REG_LINE_INTERRUPT_VALUE_L    | Holds the eight LSBs of the line on which a raster interrupt should occur (see section 3.12.4, page 125)                                                                                                                                                                                                                            |
| RW  | $26  |                               | Pixel X offset (0-255) to use when drawing ULA Layer                                                                                                                                                                                                                                                                                |
| RW  | $27  |                               | Pixel Y offset (0-191) to use when drawing ULA Layer                                                                                                                                                                                                                                                                                |
| RW  | $28  | REG_KEYMAP_ADDRESS_H          | PS/2 Keymap address MSB, read (pending) first byte of palette colour                                                                                                                                                                                                                                                                |
| -W  | $29  | REG_KEYMAP_ADDRESS_L          | PS/2 Keymap address LSB                                                                                                                                                                                                                                                                                                             |
| -W  | $2A  | REG_KEYMAP_DATA_H             | High data to PS/2 Keymap (MSB of data in bit 0)                                                                                                                                                                                                                                                                                     |
| -W  | $2B  | REG_KEYMAP_DATA_L             | Low eight LSBs of PS/2 Keymap data                                                                                                                                                                                                                                                                                                  |
| RW  | $2C  |                               | DAC B mirror, read current I2S left MSB                                                                                                                                                                                                                                                                                             |
| RW  | $2D  | REG_DAC_MONO                  | SpecDrum port 0xDF / DAC A+D mirror, read current I2S LSB                                                                                                                                                                                                                                                                           |
| RW  | $2E  |                               | DAC C mirror, read current I2S right MSB                                                                                                                                                                                                                                                                                            |
| RW  | $2F  |                               | Sets the pixel offset (two high bits) used for drawing Tilemap graphics on the screen (see section 3.7.6, page 90)                                                                                                                                                                                                                  |
| RW  | $30  |                               | Sets the pixel offset (eight low bits) used for drawing Tilemap graphics on the screen (see section 3.7.6, page 90)                                                                                                                                                                                                                 |
| RW  | $31  |                               | Sets the pixel offset used for drawing Tilemap graphics on the screen (see section 3.7.6, page 90)                                                                                                                                                                                                                                  |
| RW  | $32  | REG_LORES_OFFSET_X            | Pixel X offset (0-255) to use when drawing LoRes Layer                                                                                                                                                                                                                                                                              |
| RW  | $33  | REG_LORES_OFFSET_Y            | Pixel Y offset (0-191) to use when drawing LoRes Layer                                                                                                                                                                                                                                                                              |
| RW  | $34  |                               | Selects sprite index 0-127 to be affected by writes to other Sprite ports (and mirrors) (see section 3.8.7, page 101)                                                                                                                                                                                                               |
| -W  | $35  |                               | Writes directly into byte 1 of port $xx57 (see section 3.8.7, page 102)                                                                                                                                                                                                                                                             |
| -W  | $36  |                               | Writes directly into byte 2 of port $xx57 (see section 3.8.7, page 102)                                                                                                                                                                                                                                                             |
| -W  | $37  |                               | Writes directly into byte 3 of port $xx57 (see section 3.8.7, page 102)                                                                                                                                                                                                                                                             |
| -W  | $38  |                               | Writes directly into byte 4 of port $xx57 (see section 3.8.7, page 102)                                                                                                                                                                                                                                                             |
| -W  | $39  |                               | Writes directly into byte 5 of port $xx57 (see section 3.8.7, page 103)                                                                                                                                                                                                                                                             |
| RW  | $40  | REG_PALETTE_INDEX             | Chooses a palette element (index) to manipulate with (see section 3.4.5, page 63)                                                                                                                                                                                                                                                   |
| RW  | $41  | REG_PALETTE_VALUE_8           | Use to set/read 8-bit colours of the ULANext palette (see section 3.4.5, page 64)                                                                                                                                                                                                                                                   |
| RW  | $42  | REG_ULANEXT_PALETTE_FORMAT    | Specifies mask to extract ink colour from attribute cell value in ULANext mode                                                                                                                                                                                                                                                      |
| RW  | $43  | REG_PALETTE_CONTROL           | Enables or disables Enhanced ULA interpretation of attribute values and toggles active palette (see section 3.4.5, page 65)                                                                                                                                                                                                         |
| RW  | $44  | REG_PALETTE_VALUE_16          | Sets 9-bit (2-byte) colours of the Enhanced ULA palette, or to read second byte of colour (see section 3.4.5, page 65)                                                                                                                                                                                                              |
| RW  | $4A  | REG_FALLBACK_COLOR            | 8-bit colour to be used when all layers contain transparent pixel (see section 3.4.5, page 66)                                                                                                                                                                                                                                      |
| RW  | $4B  | REG_SPRITE_TRANSPARENCY_INDEX | Index of transparent colour in sprite palette (see section 3.8.7, page 104)                                                                                                                                                                                                                                                         |
| RW  | $4C  |                               | Index of transparent colour in Tilemap palette (see section 3.7.6, page 90)                                                                                                                                                                                                                                                         |
| RW  | $50  | REG_MMU0                      | Selects the 8k-bank stored in 8k-slot 0 (see section 3.2.7, page 42)                                                                                                                                                                                                                                                                |
| RW  | $51  | REG_MMU1                      | Selects the 8k-bank stored in 8k-slot 1 (see section 3.2.7, page 42)                                                                                                                                                                                                                                                                |
| RW  | $52  | REG_MMU2                      | Selects the 8k-bank stored in 8k-slot 2 (see section 3.2.7, page 42)                                                                                                                                                                                                                                                                |
| RW  | $53  | REG_MMU3                      | Selects the 8k-bank stored in 8k-slot 3 (see section 3.2.7, page 42)                                                                                                                                                                                                                                                                |
| RW  | $54  | REG_MMU4                      | Selects the 8k-bank stored in 8k-slot 4 (see section 3.2.7, page 42)                                                                                                                                                                                                                                                                |
| RW  | $55  | REG_MMU5                      | Selects the 8k-bank stored in 8k-slot 5 (see section 3.2.7, page 42)                                                                                                                                                                                                                                                                |
| RW  | $56  | REG_MMU6                      | Selects the 8k-bank stored in 8k-slot 6 (see section 3.2.7, page 42)                                                                                                                                                                                                                                                                |
| RW  | $57  | REG_MMU7                      | Selects the 8k-bank stored in 8k-slot 7 (see section 3.2.7, page 42)                                                                                                                                                                                                                                                                |
| -W  | $60  | REG_COPPER_DATA               | Used to upload code to the Copper (see section 3.9.4, page 109)                                                                                                                                                                                                                                                                     |
| RW  | $61  | REG_COPPER_CONTROL_L          | Holds low byte of Copper control bits (see section 3.9.4, page 109)                                                                                                                                                                                                                                                                 |
| RW  | $62  | REG_COPPER_CONTROL_H          | Holds high byte of Copper control flags (see section 3.9.4, page 109)                                                                                                                                                                                                                                                               |
| -W  | $63  |                               | Used to upload code to the Copper in 16-bit chunks (see section 3.9.4, page 109)                                                                                                                                                                                                                                                    |
| RW  | $64  |                               | Offset numbering of raster lines in copper/interrupt/active register (see section 3.12.4, page 125)                                                                                                                                                                                                                                 |
| RW  | $68  |                               | Disable ULA, controls ULA mixing/blending, enable ULA+ (see section 3.7.6, page 91)                                                                                                                                                                                                                                                 |
| RW  | $69  |                               | Layer2, ULA shadow, Timex $FF port (see section 3.6.8, page 84)                                                                                                                                                                                                                                                                     |
| RW  | $6A  |                               | LoRes Radastan mode                                                                                                                                                                                                                                                                                                                 |
| RW  | $6B  |                               | Controls Tilemap mode (see section 3.7.6, page 91)                                                                                                                                                                                                                                                                                  |
| RW  | $6C  |                               | Default tile attribute for 8-bit only maps (see section 3.7.6, page 92)                                                                                                                                                                                                                                                             |
| RW  | $6E  |                               | Base address of the 40x32 or 80x32 tile map (see section 3.7.6, page 92)                                                                                                                                                                                                                                                            |
| RW  | $6F  |                               | Base address of the tiles’ graphics (see section 3.7.6, page 92)                                                                                                                                                                                                                                                                    |
| RW  | $70  |                               | Layer 2 resolution, palette offset (see section 3.6.8, page 84)                                                                                                                                                                                                                                                                     |
| RW  | $71  |                               | Sets pixel offset for drawing Layer 2 graphics on the screen (see section 3.9.4, page 109)                                                                                                                                                                                                                                          |
| -W  | $75  |                               | Same as register $35 plus increments $34 (see section 3.8.7, page 104)                                                                                                                                                                                                                                                              |
| -W  | $76  |                               | Same as register $36 plus increments $34 (see section 3.8.7, page 104)                                                                                                                                                                                                                                                              |
| -W  | $77  |                               | Same as register $37 plus increments $34 (see section 3.8.7, page 104)                                                                                                                                                                                                                                                              |
| -W  | $78  |                               | Same as register $38 plus increments $34 (see section 3.8.7, page 104)                                                                                                                                                                                                                                                              |
| -W  | $79  |                               | Same as register $39 plus increments $34 (see section 3.8.7, page 104)                                                                                                                                                                                                                                                              |
| RW  | $7F  |                               | 8-bit storage for user                                                                                                                                                                                                                                                                                                              |
| RW  | $80  |                               | Expansion bus enable/config                                                                                                                                                                                                                                                                                                         |
| RW  | $81  |                               | Expansion bus controls                                                                                                                                                                                                                                                                                                              |
| RW  | $82  |                               | Enabling internal ports decoding bits 0-7 register                                                                                                                                                                                                                                                                                  |
| RW  | $83  |                               | Enabling internal ports decoding bits 8-15 register                                                                                                                                                                                                                                                                                 |
| RW  | $84  |                               | Enabling internal ports decoding bits 16-23 register                                                                                                                                                                                                                                                                                |
| RW  | $85  |                               | Enabling internal ports decoding bits 24-31 register                                                                                                                                                                                                                                                                                |
| RW  | $86  |                               | When expansion bus is enabled: internal ports decoding mask bits 0-7                                                                                                                                                                                                                                                                |
| RW  | $87  |                               | When expansion bus is enabled: internal ports decoding mask bits 8-15                                                                                                                                                                                                                                                               |
| RW  | $88  |                               | When expansion bus is enabled: internal ports decoding mask bits 16-23                                                                                                                                                                                                                                                              |
| RW  | $89  |                               | When expansion bus is enabled: internal ports decoding mask bits 24-31                                                                                                                                                                                                                                                              |
| RW  | $8A  |                               | Monitoring internal I/O or adding external keyboard                                                                                                                                                                                                                                                                                 |
| RW  | $8C  |                               | Enable alternate ROM or lock 48k ROM                                                                                                                                                                                                                                                                                                |
| RW  | $8E  |                               | Control classic Spectrum memory mapping                                                                                                                                                                                                                                                                                             |
| RW  | $90  |                               | -93 Enables GPIO pins output                                                                                                                                                                                                                                                                                                        |
| RW  | $98  |                               | -9B GPIO pins mapped to Next Register                                                                                                                                                                                                                                                                                               |
| RW  | $A0  |                               | Enable Pi peripherals: UART, Pi hats, I2C, SPI                                                                                                                                                                                                                                                                                      |
| RW  | $A2  |                               | Pi I2S controls                                                                                                                                                                                                                                                                                                                     |
| RW  | $A3  |                               | Pi I2S clock divide in master mode                                                                                                                                                                                                                                                                                                  |
| RW  | $A8  |                               | ESP WiFi GPIO output                                                                                                                                                                                                                                                                                                                |
| RW  | $A9  |                               | ESP WiFi GPIO read/write                                                                                                                                                                                                                                                                                                            |
| R-  | $B0  |                               | Read Next keyboard compound keys separately (see section 3.11.3, page 118)                                                                                                                                                                                                                                                          |
| R-  | $B1  |                               | Read Next keyboard compound keys separately (see section 3.11.3, page 118)                                                                                                                                                                                                                                                          |
| RW  | $B2  |                               | DivMMC trap configuration                                                                                                                                                                                                                                                                                                           |
| RW  | $B4  |                               | DivMMC trap configuration                                                                                                                                                                                                                                                                                                           |
| RW  | $C0  |                               | Interrupt Control (see section 3.12.4, page 126)                                                                                                                                                                                                                                                                                    |
| RW  | $C2  |                               | NMI Return Address LSB (see section 3.12.4, page 126)                                                                                                                                                                                                                                                                               |
| RW  | $C3  |                               | NMI Return Address MSB (see section 3.12.4, page 126)                                                                                                                                                                                                                                                                               |
| RW  | $C4  |                               | Interrupt Enable 0 (see section 3.12.4, page 126)                                                                                                                                                                                                                                                                                   |
| RW  | $C5  |                               | Interrupt Enable 1 (see section 3.12.4, page 126)                                                                                                                                                                                                                                                                                   |
| RW  | $C6  |                               | Interrupt Enable 2 (see section 3.12.4, page 127)                                                                                                                                                                                                                                                                                   |
| RW  | $C8  |                               | Interrupt Status 0 (see section 3.12.4, page 127)                                                                                                                                                                                                                                                                                   |
| RW  | $C9  |                               | Interrupt Status 1 (see section 3.12.4, page 127)                                                                                                                                                                                                                                                                                   |
| RW  | $CA  |                               | Interrupt Status 2 (see section 3.12.4, page 128)                                                                                                                                                                                                                                                                                   |
| RW  | $CC  |                               | DMA Interrupt Enable 0 (see section 3.12.4, page 128)                                                                                                                                                                                                                                                                               |
| RW  | $CD  |                               | DMA Interrupt Enable 1 (see section 3.12.4, page 128)                                                                                                                                                                                                                                                                               |
| RW  | $CE  |                               | DMA Interrupt Enable 2 (see section 3.12.4, page 129)                                                                                                                                                                                                                                                                               |
| -W  | $FF  |                               | Turns debug LEDs on and off on TBBlue implementations that have them                                                                                                                                                                                                                                                                |

