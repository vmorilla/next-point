/tmp/tmpiSaKuu3s.asm:
     1                          MODULE menu_player_choice_c
     2                          LINE 0, "menu_player_choice.c"
menu_player_choice.c:
                                
     1                          ;--------------------------------------------------------
     2                          ; File Created by SDCC : free open source ISO C Compiler
     3                          ; Version 4.3.0 #14210 (Mac OS X ppc)
     4                          ;--------------------------------------------------------
     5                          	.zxn
     6                          ; Processed by Z88DK
     7                          ;--------------------------------------------------------
     8                          
     9                          	EXTERN __divschar
    10                          	EXTERN __divschar_callee
    11                          	EXTERN __divsint
    12                          	EXTERN __divsint_callee
    13                          	EXTERN __divslong
    14                          	EXTERN __divslong_callee
    15                          	EXTERN __divslonglong
    16                          	EXTERN __divslonglong_callee
    17                          	EXTERN __divsuchar
    18                          	EXTERN __divsuchar_callee
    19                          	EXTERN __divuchar
    20                          	EXTERN __divuchar_callee
    21                          	EXTERN __divuint
    22                          	EXTERN __divuint_callee
    23                          	EXTERN __divulong
    24                          	EXTERN __divulong_callee
    25                          	EXTERN __divulonglong
    26                          	EXTERN __divulonglong_callee
    27                          	EXTERN __divuschar
    28                          	EXTERN __divuschar_callee
    29                          	EXTERN __modschar
    30                          	EXTERN __modschar_callee
    31                          	EXTERN __modsint
    32                          	EXTERN __modsint_callee
    33                          	EXTERN __modslong
    34                          	EXTERN __modslong_callee
    35                          	EXTERN __modslonglong
    36                          	EXTERN __modslonglong_callee
    37                          	EXTERN __modsuchar
    38                          	EXTERN __modsuchar_callee
    39                          	EXTERN __moduchar
    40                          	EXTERN __moduchar_callee
    41                          	EXTERN __moduint
    42                          	EXTERN __moduint_callee
    43                          	EXTERN __modulong
    44                          	EXTERN __modulong_callee
    45                          	EXTERN __modulonglong
    46                          	EXTERN __modulonglong_callee
    47                          	EXTERN __moduschar
    48                          	EXTERN __moduschar_callee
    49                          	EXTERN __mulint
    50                          	EXTERN __mulint_callee
    51                          	EXTERN __mullong
    52                          	EXTERN __mullong_callee
    53                          	EXTERN __mullonglong
    54                          	EXTERN __mullonglong_callee
    55                          	EXTERN __mulschar
    56                          	EXTERN __mulschar_callee
    57                          	EXTERN __mulsuchar
    58                          	EXTERN __mulsuchar_callee
    59                          	EXTERN __muluchar
    60                          	EXTERN __muluchar_callee
    61                          	EXTERN __muluschar
    62                          	EXTERN __muluschar_callee
    63                          	EXTERN __rlslonglong
    64                          	EXTERN __rlslonglong_callee
    65                          	EXTERN __rlulonglong
    66                          	EXTERN __rlulonglong_callee
    67                          	EXTERN __rrslonglong
    68                          	EXTERN __rrslonglong_callee
    69                          	EXTERN __rrulonglong
    70                          	EXTERN __rrulonglong_callee
    71                          	EXTERN ___mulsint2slong
    72                          	EXTERN ___mulsint2slong_callee
    73                          	EXTERN ___muluint2ulong
    74                          	EXTERN ___muluint2ulong_callee
    75                          	EXTERN ___sdcc_call_hl
    76                          	EXTERN ___sdcc_call_iy
    77                          	EXTERN ___sdcc_enter_ix
    78                          	EXTERN banked_call
    79                          	EXTERN _banked_ret
    80                          	EXTERN ___fs2schar
    81                          	EXTERN ___fs2schar_callee
    82                          	EXTERN ___fs2sint
    83                          	EXTERN ___fs2sint_callee
    84                          	EXTERN ___fs2slong
    85                          	EXTERN ___fs2slong_callee
    86                          	EXTERN ___fs2slonglong
    87                          	EXTERN ___fs2slonglong_callee
    88                          	EXTERN ___fs2uchar
    89                          	EXTERN ___fs2uchar_callee
    90                          	EXTERN ___fs2uint
    91                          	EXTERN ___fs2uint_callee
    92                          	EXTERN ___fs2ulong
    93                          	EXTERN ___fs2ulong_callee
    94                          	EXTERN ___fs2ulonglong
    95                          	EXTERN ___fs2ulonglong_callee
    96                          	EXTERN ___fsadd
    97                          	EXTERN ___fsadd_callee
    98                          	EXTERN ___fsdiv
    99                          	EXTERN ___fsdiv_callee
   100                          	EXTERN ___fseq
   101                          	EXTERN ___fseq_callee
   102                          	EXTERN ___fsgt
   103                          	EXTERN ___fsgt_callee
   104                          	EXTERN ___fslt
   105                          	EXTERN ___fslt_callee
   106                          	EXTERN ___fsmul
   107                          	EXTERN ___fsmul_callee
   108                          	EXTERN ___fsneq
   109                          	EXTERN ___fsneq_callee
   110                          	EXTERN ___fssub
   111                          	EXTERN ___fssub_callee
   112                          	EXTERN ___schar2fs
   113                          	EXTERN ___schar2fs_callee
   114                          	EXTERN ___sint2fs
   115                          	EXTERN ___sint2fs_callee
   116                          	EXTERN ___slong2fs
   117                          	EXTERN ___slong2fs_callee
   118                          	EXTERN ___slonglong2fs
   119                          	EXTERN ___slonglong2fs_callee
   120                          	EXTERN ___uchar2fs
   121                          	EXTERN ___uchar2fs_callee
   122                          	EXTERN ___uint2fs
   123                          	EXTERN ___uint2fs_callee
   124                          	EXTERN ___ulong2fs
   125                          	EXTERN ___ulong2fs_callee
   126                          	EXTERN ___ulonglong2fs
   127                          	EXTERN ___ulonglong2fs_callee
   128                          	EXTERN ____sdcc_2_copy_src_mhl_dst_deix
   129                          	EXTERN ____sdcc_2_copy_src_mhl_dst_bcix
   130                          	EXTERN ____sdcc_4_copy_src_mhl_dst_deix
   131                          	EXTERN ____sdcc_4_copy_src_mhl_dst_bcix
   132                          	EXTERN ____sdcc_4_copy_src_mhl_dst_mbc
   133                          	EXTERN ____sdcc_4_ldi_nosave_bc
   134                          	EXTERN ____sdcc_4_ldi_save_bc
   135                          	EXTERN ____sdcc_4_push_hlix
   136                          	EXTERN ____sdcc_4_push_mhl
   137                          	EXTERN ____sdcc_lib_setmem_hl
   138                          	EXTERN ____sdcc_ll_add_de_bc_hl
   139                          	EXTERN ____sdcc_ll_add_de_bc_hlix
   140                          	EXTERN ____sdcc_ll_add_de_hlix_bc
   141                          	EXTERN ____sdcc_ll_add_de_hlix_bcix
   142                          	EXTERN ____sdcc_ll_add_deix_bc_hl
   143                          	EXTERN ____sdcc_ll_add_deix_hlix
   144                          	EXTERN ____sdcc_ll_add_hlix_bc_deix
   145                          	EXTERN ____sdcc_ll_add_hlix_deix_bc
   146                          	EXTERN ____sdcc_ll_add_hlix_deix_bcix
   147                          	EXTERN ____sdcc_ll_asr_hlix_a
   148                          	EXTERN ____sdcc_ll_asr_mbc_a
   149                          	EXTERN ____sdcc_ll_copy_src_de_dst_hlix
   150                          	EXTERN ____sdcc_ll_copy_src_de_dst_hlsp
   151                          	EXTERN ____sdcc_ll_copy_src_deix_dst_hl
   152                          	EXTERN ____sdcc_ll_copy_src_deix_dst_hlix
   153                          	EXTERN ____sdcc_ll_copy_src_deixm_dst_hlsp
   154                          	EXTERN ____sdcc_ll_copy_src_desp_dst_hlsp
   155                          	EXTERN ____sdcc_ll_copy_src_hl_dst_de
   156                          	EXTERN ____sdcc_ll_copy_src_hlsp_dst_de
   157                          	EXTERN ____sdcc_ll_copy_src_hlsp_dst_deixm
   158                          	EXTERN ____sdcc_ll_lsl_hlix_a
   159                          	EXTERN ____sdcc_ll_lsl_mbc_a
   160                          	EXTERN ____sdcc_ll_lsr_hlix_a
   161                          	EXTERN ____sdcc_ll_lsr_mbc_a
   162                          	EXTERN ____sdcc_ll_push_hlix
   163                          	EXTERN ____sdcc_ll_push_mhl
   164                          	EXTERN ____sdcc_ll_sub_de_bc_hl
   165                          	EXTERN ____sdcc_ll_sub_de_bc_hlix
   166                          	EXTERN ____sdcc_ll_sub_de_hlix_bc
   167                          	EXTERN ____sdcc_ll_sub_de_hlix_bcix
   168                          	EXTERN ____sdcc_ll_sub_deix_bc_hl
   169                          	EXTERN ____sdcc_ll_sub_deix_hlix
   170                          	EXTERN ____sdcc_ll_sub_hlix_bc_deix
   171                          	EXTERN ____sdcc_ll_sub_hlix_deix_bc
   172                          	EXTERN ____sdcc_ll_sub_hlix_deix_bcix
   173                          	EXTERN ____sdcc_load_debc_deix
   174                          	EXTERN ____sdcc_load_dehl_deix
   175                          	EXTERN ____sdcc_load_debc_mhl
   176                          	EXTERN ____sdcc_load_hlde_mhl
   177                          	EXTERN ____sdcc_store_dehl_bcix
   178                          	EXTERN ____sdcc_store_debc_hlix
   179                          	EXTERN ____sdcc_store_debc_mhl
   180                          	EXTERN ____sdcc_cpu_pop_ei
   181                          	EXTERN ____sdcc_cpu_pop_ei_jp
   182                          	EXTERN ____sdcc_cpu_push_di
   183                          	EXTERN ____sdcc_outi
   184                          	EXTERN ____sdcc_outi_128
   185                          	EXTERN ____sdcc_outi_256
   186                          	EXTERN ____sdcc_ldi
   187                          	EXTERN ____sdcc_ldi_128
   188                          	EXTERN ____sdcc_ldi_256
   189                          	EXTERN ____sdcc_4_copy_srcd_hlix_dst_deix
   190                          	EXTERN ____sdcc_4_and_src_mbc_mhl_dst_deix
   191                          	EXTERN ____sdcc_4_or_src_mbc_mhl_dst_deix
   192                          	EXTERN ____sdcc_4_xor_src_mbc_mhl_dst_deix
   193                          	EXTERN ____sdcc_4_or_src_dehl_dst_bcix
   194                          	EXTERN ____sdcc_4_xor_src_dehl_dst_bcix
   195                          	EXTERN ____sdcc_4_and_src_dehl_dst_bcix
   196                          	EXTERN ____sdcc_4_xor_src_mbc_mhl_dst_debc
   197                          	EXTERN ____sdcc_4_or_src_mbc_mhl_dst_debc
   198                          	EXTERN ____sdcc_4_and_src_mbc_mhl_dst_debc
   199                          	EXTERN ____sdcc_4_cpl_src_mhl_dst_debc
   200                          	EXTERN ____sdcc_4_xor_src_debc_mhl_dst_debc
   201                          	EXTERN ____sdcc_4_or_src_debc_mhl_dst_debc
   202                          	EXTERN ____sdcc_4_and_src_debc_mhl_dst_debc
   203                          	EXTERN ____sdcc_4_and_src_debc_hlix_dst_debc
   204                          	EXTERN ____sdcc_4_or_src_debc_hlix_dst_debc
   205                          	EXTERN ____sdcc_4_xor_src_debc_hlix_dst_debc
   206                          
   207                          ;--------------------------------------------------------
   208                          ; Public variables in this module
   209                          ;--------------------------------------------------------
   210                          	GLOBAL _player_choice_menu
   211                          ;--------------------------------------------------------
   212                          ; Externals used
   213                          ;--------------------------------------------------------
   214                          	GLOBAL _sfx_play_sync
   215                          	GLOBAL _sfx_init
   216                          	GLOBAL _reset_ticks
   217                          	GLOBAL _wait_for_ticks
   218                          	GLOBAL _clear_tilemap
   219                          	GLOBAL _select_tilemap
   220                          	GLOBAL _menu_go_back
   221                          	GLOBAL _handle_std_menu
   222                          	GLOBAL _read_menu_input
   223                          	GLOBAL _diplay_profile
   224                          	GLOBAL _swap_layer2_screen
   225                          	GLOBAL _load_layer2_shadow_screen
   226                          	GLOBAL _load_layer2_screen
   227                          	GLOBAL _intrinsic_swap_word_32_fastcall
   228                          	GLOBAL _intrinsic_swap_word_32
   229                          	GLOBAL _intrinsic_swap_endian_32_fastcall
   230                          	GLOBAL _intrinsic_swap_endian_32
   231                          	GLOBAL _intrinsic_swap_endian_16_fastcall
   232                          	GLOBAL _intrinsic_swap_endian_16
   233                          	GLOBAL _intrinsic_return_de
   234                          	GLOBAL _intrinsic_return_bc
   235                          	GLOBAL _intrinsic_exx
   236                          	GLOBAL _intrinsic_ex_de_hl
   237                          	GLOBAL _intrinsic_nop
   238                          	GLOBAL _intrinsic_im_2
   239                          	GLOBAL _intrinsic_im_1
   240                          	GLOBAL _intrinsic_im_0
   241                          	GLOBAL _intrinsic_retn
   242                          	GLOBAL _intrinsic_reti
   243                          	GLOBAL _intrinsic_halt
   244                          	GLOBAL _intrinsic_ei
   245                          	GLOBAL _intrinsic_di
   246                          	GLOBAL _intrinsic_stub
   247                          	GLOBAL _intrinsic_ini
   248                          	GLOBAL _intrinsic_outi
   249                          	GLOBAL _intrinsic_ldi
   250                          	GLOBAL _tilemap
   251                          	GLOBAL _balloon_tilemap
   252                          	GLOBAL _menu_palette_end
   253                          	GLOBAL _menu_palette
   254                          	GLOBAL _menu_patterns
   255                          	GLOBAL _game_palette_end
   256                          	GLOBAL _game_palette
   257                          	GLOBAL _game_patterns
   258                          	GLOBAL _tiles
   259                          	GLOBAL _game_settings
   260                          	GLOBAL _ppponent_profile
   261                          	GLOBAL _ly2_player_selection
   262                          	GLOBAL _ly2_intro_screen
   263                          	GLOBAL _ly2_court_sidney
   264                          	GLOBAL _ly2_court_madrid
   265                          	GLOBAL _ly2_court_london
   266                          ;--------------------------------------------------------
   267                          ; special function registers
   268                          ;--------------------------------------------------------
   269                          ;--------------------------------------------------------
   270                          ; ram data
   271                          ;--------------------------------------------------------
   272                          	SECTION bss_compiler
   273                          ;--------------------------------------------------------
   274                          ; ram data
   275                          ;--------------------------------------------------------
   276                          
   277                          IF 0
   278                          
   279                          ; .area _INITIALIZED removed by z88dk
   280                          
   281                          
   282                          ENDIF
   283                          
   284                          ;--------------------------------------------------------
   285                          ; absolute external ram data
   286                          ;--------------------------------------------------------
   287                          	SECTION IGNORE
   288                          ;--------------------------------------------------------
   289                          ; global & static initialisations
   290                          ;--------------------------------------------------------
   291                          	SECTION code_crt_init
   292                          ;--------------------------------------------------------
   293                          ; Home
   294                          ;--------------------------------------------------------
   295                          	SECTION IGNORE
   296                          ;--------------------------------------------------------
   297                          ; code
   298                          ;--------------------------------------------------------
   299                          	SECTION BANK_8
   300                          ;menu_player_choice.c:32: tilemap[y][x].character = character;
   301                          ;	---------------------------------
   302                          ; Function draw_char
   303                          ; ---------------------------------
   304                          _draw_char:
   305  0000  cd0000            	call	___sdcc_enter_ix
   306                          ;menu_player_choice.c:34: tilemap[y][x].x_mirror = x_mirror;
   307  0003  dd5e05            	ld	e,(ix+5)
   308  0006  16a0              	ld	d,0xa0
   309  0008  ed30              	mlt	de
   310  000a  210000            	ld	hl,_tilemap
   311  000d  19                	add	hl, de
   312  000e  eb                	ex	de, hl
   313  000f  dd7e04            	ld	a,(ix+4)
   314  0012  87                	add	a, a
   315  0013  83                	add	a, e
   316  0014  4f                	ld	c, a
   317  0015  3e00              	ld	a,0x00
   318  0017  8a                	adc	a, d
   319  0018  47                	ld	b, a
   320  0019  dd7e06            	ld	a,(ix+6)
   321  001c  02                	ld	(bc), a
   322                          ;menu_player_choice.c:35: tilemap[y][x].y_mirror = y_mirror;
   323  001d  03                	inc	bc
   324  001e  dd7e09            	ld	a,(ix+9)
   325  0021  87                	add	a, a
   326  0022  87                	add	a, a
   327  0023  87                	add	a, a
   328  0024  87                	add	a, a
   329  0025  5f                	ld	e, a
   330  0026  0a                	ld	a, (bc)
   331  0027  e60f              	and	a,0x0f
   332  0029  b3                	or	a, e
   333  002a  02                	ld	(bc), a
   334                          ;menu_player_choice.c:36: }
   335  002b  59                	ld	e, c
   336  002c  50                	ld	d, b
   337  002d  af                	xor	a, a
   338  002e  ddbe07            	cp	a,(ix+7)
   339  0031  17                	rla
   340  0032  ed23              	swap	a
   341  0034  0f                	rrca
   342  0035  e608              	and	a,0x08
   343  0037  6f                	ld	l, a
   344  0038  1a                	ld	a, (de)
   345  0039  e6f7              	and	a,0xf7
   346  003b  b5                	or	a, l
   347  003c  12                	ld	(de), a
   348                          ;menu_player_choice.c:37:
   349  003d  af                	xor	a, a
   350  003e  ddbe08            	cp	a,(ix+8)
   351  0041  17                	rla
   352  0042  07                	rlca
   353  0043  07                	rlca
   354  0044  e604              	and	a,0x04
   355  0046  5f                	ld	e, a
   356  0047  0a                	ld	a, (bc)
   357  0048  e6fb              	and	a,0xfb
   358  004a  b3                	or	a, e
   359  004b  02                	ld	(bc), a
   360                          ;menu_player_choice.c:38: static void
   361  004c  dde1              	pop	ix
   362  004e  c9                	ret
   363                          ;menu_player_choice.c:41: x = x * (AVATAR_BOX_WIDTH + AVATAR_BOX_SEPARATION_X) + AVATAR_BOX_FIRST_COLUMN;
   364                          ;	---------------------------------
   365                          ; Function draw_selection_box
   366                          ; ---------------------------------
   367                          _draw_selection_box:
   368  004f  cd0000            	call	___sdcc_enter_ix
   369                          ;menu_player_choice.c:43:
   370  0052  dd7e04            	ld	a,(ix+4)
   371  0055  4f                	ld	c, a
   372  0056  87                	add	a, a
   373  0057  81                	add	a, c
   374  0058  87                	add	a, a
   375  0059  87                	add	a, a
   376  005a  c605              	add	a,0x05
   377  005c  dd7704            	ld	(ix+4),a
   378                          ;menu_player_choice.c:44: // Draw the corners
   379  005f  dd7e05            	ld	a,(ix+5)
   380  0062  4f                	ld	c, a
   381  0063  87                	add	a, a
   382  0064  81                	add	a, c
   383  0065  87                	add	a, a
   384  0066  c607              	add	a,0x07
   385  0068  dd7705            	ld	(ix+5),a
   386                          ;menu_player_choice.c:47: draw_char(x, y + AVATAR_BOX_HEIGHT + 1, CORNER_CHAR, false, true, palette);
   387  006b  dd6606            	ld	h,(ix+6)
   388  006e  af                	xor	a,a
   389  006f  6f                	ld	l,a
   390  0070  e5                	push	hl
   391  0071  af                	xor	a, a
   392  0072  57                	ld	d,a
   393  0073  1e7d              	ld	e,0x7d
   394  0075  d5                	push	de
   395  0076  dd6605            	ld	h,(ix+5)
   396  0079  dd6e04            	ld	l,(ix+4)
   397  007c  e5                	push	hl
   398  007d  cd0000            	call	_draw_char
   399  0080  f1                	pop	af
   400  0081  f1                	pop	af
   401  0082  f1                	pop	af
   402                          ;menu_player_choice.c:48: draw_char(x + AVATAR_BOX_WIDTH + 1, y + AVATAR_BOX_HEIGHT + 1, CORNER_CHAR, true, true, palette);
   403  0083  dd7e04            	ld	a,(ix+4)
   404  0086  c609              	add	a,0x09
   405  0088  4f                	ld	c, a
   406  0089  c5                	push	bc
   407  008a  dd7e06            	ld	a,(ix+6)
   408  008d  f5                	push	af
   409  008e  33                	inc	sp
   410  008f  af                	xor	a, a
   411  0090  57                	ld	d,a
   412  0091  1e01              	ld	e,0x01
   413  0093  d5                	push	de
   414  0094  267d              	ld	h,0x7d
   415  0096  dd6e05            	ld	l,(ix+5)
   416  0099  e5                	push	hl
   417  009a  79                	ld	a, c
   418  009b  f5                	push	af
   419  009c  33                	inc	sp
   420  009d  cd0000            	call	_draw_char
   421  00a0  f1                	pop	af
   422  00a1  f1                	pop	af
   423  00a2  f1                	pop	af
   424  00a3  c1                	pop	bc
   425                          ;menu_player_choice.c:49:
   426  00a4  dd7e05            	ld	a,(ix+5)
   427  00a7  c605              	add	a,0x05
   428  00a9  47                	ld	b, a
   429  00aa  c5                	push	bc
   430  00ab  dd5606            	ld	d,(ix+6)
   431  00ae  1e01              	ld	e,0x01
   432  00b0  d5                	push	de
   433  00b1  af                	xor	a, a
   434  00b2  57                	ld	d,a
   435  00b3  1e7d              	ld	e,0x7d
   436  00b5  d5                	push	de
   437  00b6  dd4e04            	ld	c,(ix+4)
   438  00b9  c5                	push	bc
   439  00ba  cd0000            	call	_draw_char
   440  00bd  f1                	pop	af
   441  00be  f1                	pop	af
   442  00bf  f1                	pop	af
   443  00c0  c1                	pop	bc
   444                          ;menu_player_choice.c:50: for (uint8_t i = 1; i < AVATAR_BOX_WIDTH + 1; i++)
   445  00c1  c5                	push	bc
   446  00c2  dd5606            	ld	d,(ix+6)
   447  00c5  1e01              	ld	e,0x01
   448  00c7  d5                	push	de
   449  00c8  117d01            	ld	de,0x017d
   450  00cb  d5                	push	de
   451  00cc  c5                	push	bc
   452  00cd  cd0000            	call	_draw_char
   453  00d0  f1                	pop	af
   454  00d1  f1                	pop	af
   455  00d2  f1                	pop	af
   456  00d3  c1                	pop	bc
   457                          ;menu_player_choice.c:52: draw_char(x + i, y, BORDER_CHAR_HOR, false, false, palette);
   458  00d4  1e01              	ld	e,0x01
   459                          l_draw_selection_box_00104:
   460  00d6  7b                	ld	a, e
   461  00d7  d609              	sub	a,0x09
   462  00d9  303f              	jr	NC,l_draw_selection_box_00101
   463                          ;menu_player_choice.c:54: }
   464  00db  dd7e04            	ld	a,(ix+4)
   465  00de  83                	add	a, e
   466  00df  57                	ld	d, a
   467  00e0  c5                	push	bc
   468  00e1  d5                	push	de
   469  00e2  dd6606            	ld	h,(ix+6)
   470  00e5  af                	xor	a,a
   471  00e6  6f                	ld	l,a
   472  00e7  e5                	push	hl
   473  00e8  af                	xor	a, a
   474  00e9  47                	ld	b,a
   475  00ea  0e7e              	ld	c,0x7e
   476  00ec  c5                	push	bc
   477  00ed  dd7e05            	ld	a,(ix+5)
   478  00f0  5a                	ld	e,d
   479  00f1  57                	ld	d,a
   480  00f2  d5                	push	de
   481  00f3  cd0000            	call	_draw_char
   482  00f6  f1                	pop	af
   483  00f7  f1                	pop	af
   484  00f8  f1                	pop	af
   485  00f9  d1                	pop	de
   486  00fa  c1                	pop	bc
   487                          ;menu_player_choice.c:55:
   488  00fb  c5                	push	bc
   489  00fc  d5                	push	de
   490  00fd  dd7e06            	ld	a,(ix+6)
   491  0100  f5                	push	af
   492  0101  33                	inc	sp
   493  0102  3e01              	ld	a,0x01
   494  0104  f5                	push	af
   495  0105  33                	inc	sp
   496  0106  af                	xor	a, a
   497  0107  f5                	push	af
   498  0108  33                	inc	sp
   499  0109  3e7e              	ld	a,0x7e
   500  010b  f5                	push	af
   501  010c  33                	inc	sp
   502  010d  4a                	ld	c, d
   503  010e  c5                	push	bc
   504  010f  cd0000            	call	_draw_char
   505  0112  f1                	pop	af
   506  0113  f1                	pop	af
   507  0114  f1                	pop	af
   508  0115  d1                	pop	de
   509  0116  c1                	pop	bc
   510                          ;menu_player_choice.c:52: draw_char(x + i, y, BORDER_CHAR_HOR, false, false, palette);
   511  0117  1c                	inc	e
   512  0118  18bc              	jr	l_draw_selection_box_00104
   513                          l_draw_selection_box_00101:
   514                          ;menu_player_choice.c:58: draw_char(x, y + i, BORDER_CHAR_VERT, false, false, palette);
   515  011a  0601              	ld	b,0x01
   516                          l_draw_selection_box_00107:
   517  011c  78                	ld	a, b
   518  011d  d605              	sub	a,0x05
   519  011f  303b              	jr	NC,l_draw_selection_box_00109
   520                          ;menu_player_choice.c:60: }
   521  0121  dd7e05            	ld	a,(ix+5)
   522  0124  80                	add	a, b
   523  0125  57                	ld	d, a
   524  0126  c5                	push	bc
   525  0127  d5                	push	de
   526  0128  dd6606            	ld	h,(ix+6)
   527  012b  af                	xor	a,a
   528  012c  6f                	ld	l,a
   529  012d  e5                	push	hl
   530  012e  af                	xor	a, a
   531  012f  47                	ld	b,a
   532  0130  0e7f              	ld	c,0x7f
   533  0132  c5                	push	bc
   534  0133  dd5e04            	ld	e,(ix+4)
   535  0136  d5                	push	de
   536  0137  cd0000            	call	_draw_char
   537  013a  f1                	pop	af
   538  013b  f1                	pop	af
   539  013c  f1                	pop	af
   540  013d  d1                	pop	de
   541  013e  c1                	pop	bc
   542                          ;menu_player_choice.c:61: }
   543  013f  c5                	push	bc
   544  0140  dd6606            	ld	h,(ix+6)
   545  0143  af                	xor	a,a
   546  0144  6f                	ld	l,a
   547  0145  e5                	push	hl
   548  0146  3e01              	ld	a,0x01
   549  0148  f5                	push	af
   550  0149  33                	inc	sp
   551  014a  3e7f              	ld	a,0x7f
   552  014c  5a                	ld	e,d
   553  014d  57                	ld	d,a
   554  014e  d5                	push	de
   555  014f  79                	ld	a, c
   556  0150  f5                	push	af
   557  0151  33                	inc	sp
   558  0152  cd0000            	call	_draw_char
   559  0155  f1                	pop	af
   560  0156  f1                	pop	af
   561  0157  f1                	pop	af
   562  0158  c1                	pop	bc
   563                          ;menu_player_choice.c:58: draw_char(x, y + i, BORDER_CHAR_VERT, false, false, palette);
   564  0159  04                	inc	b
   565  015a  18c0              	jr	l_draw_selection_box_00107
   566                          l_draw_selection_box_00109:
   567                          ;menu_player_choice.c:63: int8_t player_choice_menu(int8_t entry)
   568  015c  dde1              	pop	ix
   569  015e  c9                	ret
   570                          ;menu_player_choice.c:65: (void)entry;
   571                          ;	---------------------------------
   572                          ; Function player_choice_menu
   573                          ; ---------------------------------
   574                          _player_choice_menu:
   575  015f  cd0000            	call	___sdcc_enter_ix
   576  0162  f5                	push	af
   577  0163  f5                	push	af
   578                          ;menu_player_choice.c:68: uint8_t player_selection = 0;
   579  0164  af                	xor	a, a
   580  0165  f5                	push	af
   581  0166  33                	inc	sp
   582  0167  cd0000            	call	_select_tilemap
   583  016a  33                	inc	sp
   584                          ;menu_player_choice.c:69: uint8_t player_new_selection = 0;
   585  016b  218ace            	ld	hl,0xce8a
   586  016e  e5                	push	hl
   587  016f  3e4c              	ld	a,0x4c
   588  0171  f5                	push	af
   589  0172  33                	inc	sp
   590  0173  cd0000            	call	_load_layer2_screen
   591  0176  f1                	pop	af
   592  0177  33                	inc	sp
   593                          ;menu_player_choice.c:70:
   594                          ;menu_player_choice.c:71: diplay_profile(0);
   595  0178  0e00              	ld	c,0x00
   596  017a  51                	ld	d,c
   597                          ;menu_player_choice.c:73:
   598  017b  c5                	push	bc
   599  017c  d5                	push	de
   600  017d  af                	xor	a, a
   601  017e  f5                	push	af
   602  017f  33                	inc	sp
   603  0180  cd0000            	call	_diplay_profile
   604  0183  33                	inc	sp
   605  0184  3e03              	ld	a,0x03
   606  0186  f5                	push	af
   607  0187  33                	inc	sp
   608  0188  af                	xor	a, a
   609  0189  f5                	push	af
   610  018a  33                	inc	sp
   611  018b  af                	xor	a, a
   612  018c  f5                	push	af
   613  018d  33                	inc	sp
   614  018e  cd4f00            	call	_draw_selection_box
   615  0191  f1                	pop	af
   616  0192  33                	inc	sp
   617  0193  d1                	pop	de
   618  0194  c1                	pop	bc
   619                          ;menu_player_choice.c:77: input = read_menu_input();
   620                          l_player_choice_menu_00120:
   621                          ;menu_player_choice.c:79: player_new_selection = player_selection - MENU_PLAYER_CHOICE_COLUMNS;
   622  0195  c5                	push	bc
   623  0196  d5                	push	de
   624  0197  cd0000            	call	_read_menu_input
   625  019a  d1                	pop	de
   626  019b  c1                	pop	bc
   627  019c  5d                	ld	e, l
   628                          ;menu_player_choice.c:81: player_new_selection = player_selection + MENU_PLAYER_CHOICE_COLUMNS;
   629  019d  41                	ld	b, c
   630                          ;menu_player_choice.c:82: else if (input == MENU_KEY_LEFT && player_selection > 0)
   631  019e  dd71fc            	ld	(ix-4),c
   632  01a1  dd36fd00          	ld	(ix-3),0x00
   633  01a5  c5                	push	bc
   634  01a6  d5                	push	de
   635  01a7  210300            	ld	hl,0x0003
   636  01aa  e5                	push	hl
   637  01ab  dd6efc            	ld	l,(ix-4)
   638  01ae  dd66fd            	ld	h,(ix-3)
   639  01b1  e5                	push	hl
   640                          ;menu_player_choice.c:80: else if (input == MENU_KEY_DOWN && (player_selection / MENU_PLAYER_CHOICE_COLUMNS < MENU_PLAYER_CHOICE_ROWS - 1))
   641  01b2  cd0000            	call	__divsint_callee
   642  01b5  dd75fe            	ld	(ix-2),l
   643  01b8  dd74ff            	ld	(ix-1),h
   644  01bb  d1                	pop	de
   645  01bc  c1                	pop	bc
   646  01bd  7b                	ld	a, e
   647  01be  3d                	dec	a
   648  01bf  200b              	jr	NZ,l_player_choice_menu_00113
   649  01c1  79                	ld	a, c
   650  01c2  d603              	sub	a,0x03
   651  01c4  3806              	jr	C,l_player_choice_menu_00113
   652                          ;menu_player_choice.c:81: player_new_selection = player_selection + MENU_PLAYER_CHOICE_COLUMNS;
   653  01c6  78                	ld	a, b
   654  01c7  c6fd              	add	a,0xfd
   655  01c9  57                	ld	d, a
   656  01ca  1832              	jr	l_player_choice_menu_00114
   657                          l_player_choice_menu_00113:
   658                          ;menu_player_choice.c:82: else if (input == MENU_KEY_LEFT && player_selection > 0)
   659  01cc  7b                	ld	a, e
   660  01cd  d602              	sub	a,0x02
   661  01cf  2015              	jr	NZ,l_player_choice_menu_00109
   662  01d1  dd7efe            	ld	a,(ix-2)
   663  01d4  d603              	sub	a,0x03
   664  01d6  dd7eff            	ld	a,(ix-1)
   665  01d9  17                	rla
   666  01da  3f                	ccf
   667  01db  1f                	rra
   668  01dc  de80              	sbc	a,0x80
   669  01de  3006              	jr	NC,l_player_choice_menu_00109
   670                          ;menu_player_choice.c:83: player_new_selection = player_selection - 1;
   671  01e0  50                	ld	d, b
   672  01e1  14                	inc	d
   673  01e2  14                	inc	d
   674  01e3  14                	inc	d
   675  01e4  1818              	jr	l_player_choice_menu_00114
   676                          l_player_choice_menu_00109:
   677                          ;menu_player_choice.c:84: else if (input == MENU_KEY_RIGHT && player_selection < (MENU_PLAYER_CHOICE_COLUMNS * MENU_PLAYER_CHOICE_ROWS) - 1)
   678  01e6  7b                	ld	a, e
   679  01e7  d603              	sub	a,0x03
   680  01e9  2007              	jr	NZ,l_player_choice_menu_00105
   681  01eb  b1                	or	a,c
   682  01ec  2804              	jr	Z,l_player_choice_menu_00105
   683                          ;menu_player_choice.c:85: player_new_selection = player_selection + 1;
   684  01ee  50                	ld	d, b
   685  01ef  15                	dec	d
   686  01f0  180c              	jr	l_player_choice_menu_00114
   687                          l_player_choice_menu_00105:
   688                          ;menu_player_choice.c:86: if (player_new_selection != player_selection)
   689  01f2  7b                	ld	a, e
   690  01f3  d604              	sub	a,0x04
   691  01f5  2007              	jr	NZ,l_player_choice_menu_00114
   692  01f7  79                	ld	a, c
   693  01f8  d60b              	sub	a,0x0b
   694  01fa  3002              	jr	NC,l_player_choice_menu_00114
   695                          ;menu_player_choice.c:87: {
   696  01fc  50                	ld	d, b
   697  01fd  14                	inc	d
   698                          l_player_choice_menu_00114:
   699                          ;menu_player_choice.c:88: sfx_play_sync(SFX_CURSOR_MOVE);
   700  01fe  79                	ld	a, c
   701  01ff  92                	sub	a, d
   702  0200  286b              	jr	Z,l_player_choice_menu_00121
   703                          ;menu_player_choice.c:90: wait_for_ticks(1);
   704  0202  d5                	push	de
   705  0203  af                	xor	a, a
   706  0204  f5                	push	af
   707  0205  33                	inc	sp
   708  0206  cd0000            	call	_sfx_play_sync
   709  0209  33                	inc	sp
   710  020a  cd0000            	call	_reset_ticks
   711  020d  3e01              	ld	a,0x01
   712  020f  f5                	push	af
   713  0210  33                	inc	sp
   714  0211  cd0000            	call	_wait_for_ticks
   715  0214  33                	inc	sp
   716  0215  d1                	pop	de
   717                          ;menu_player_choice.c:93: draw_selection_box(player_new_selection % MENU_PLAYER_CHOICE_COLUMNS, player_new_selection / MENU_PLAYER_CHOICE_COLUMNS, TILEMAP_PALETTE_PLAYER_CHOICE);
   718  0216  d5                	push	de
   719  0217  d5                	push	de
   720  0218  33                	inc	sp
   721  0219  cd0000            	call	_diplay_profile
   722  021c  33                	inc	sp
   723  021d  d1                	pop	de
   724                          ;menu_player_choice.c:94: player_selection = player_new_selection;
   725  021e  dd46fe            	ld	b,(ix-2)
   726  0221  c5                	push	bc
   727  0222  d5                	push	de
   728  0223  210300            	ld	hl,0x0003
   729  0226  e5                	push	hl
   730  0227  dd6efc            	ld	l,(ix-4)
   731  022a  dd66fd            	ld	h,(ix-3)
   732  022d  e5                	push	hl
   733  022e  cd0000            	call	__modsint_callee
   734  0231  d1                	pop	de
   735  0232  c1                	pop	bc
   736  0233  7d                	ld	a, l
   737  0234  d5                	push	de
   738  0235  2602              	ld	h,0x02
   739  0237  68                	ld	l,b
   740  0238  e5                	push	hl
   741  0239  f5                	push	af
   742  023a  33                	inc	sp
   743  023b  cd4f00            	call	_draw_selection_box
   744  023e  f1                	pop	af
   745  023f  33                	inc	sp
   746  0240  d1                	pop	de
   747                          ;menu_player_choice.c:95: }
   748  0241  6a                	ld	l, d
   749  0242  2600              	ld	h,0x00
   750  0244  e5                	push	hl
   751  0245  d5                	push	de
   752  0246  010300            	ld	bc,0x0003
   753  0249  c5                	push	bc
   754  024a  e5                	push	hl
   755  024b  cd0000            	call	__divsint_callee
   756  024e  d1                	pop	de
   757  024f  45                	ld	b,l
   758  0250  4c                	ld	c,h
   759  0251  e1                	pop	hl
   760  0252  c5                	push	bc
   761  0253  d5                	push	de
   762  0254  ed8a0003          	push	+0x0003
   763  0258  e5                	push	hl
   764  0259  cd0000            	call	__modsint_callee
   765  025c  d1                	pop	de
   766  025d  c1                	pop	bc
   767  025e  7d                	ld	a, l
   768  025f  d5                	push	de
   769  0260  2603              	ld	h,0x03
   770  0262  68                	ld	l,b
   771  0263  e5                	push	hl
   772  0264  f5                	push	af
   773  0265  33                	inc	sp
   774  0266  cd4f00            	call	_draw_selection_box
   775  0269  f1                	pop	af
   776  026a  33                	inc	sp
   777  026b  d1                	pop	de
   778                          ;menu_player_choice.c:96:
   779  026c  4a                	ld	c, d
   780                          l_player_choice_menu_00121:
   781                          ;menu_player_choice.c:99:
   782  026d  7b                	ld	a, e
   783  026e  d605              	sub	a,0x05
   784  0270  2004              	jr	NZ,l_player_choice_menu_00197
   785  0272  3e01              	ld	a,0x01
   786  0274  1801              	jr	l_player_choice_menu_00198
   787                          l_player_choice_menu_00197:
   788  0276  af                	xor	a,a
   789                          l_player_choice_menu_00198:
   790  0277  47                	ld	b, a
   791  0278  7b                	ld	a, e
   792  0279  d606              	sub	a,0x06
   793  027b  2003              	jr	NZ,l_player_choice_menu_00119
   794  027d  b1                	or	a,c
   795  027e  2805              	jr	Z,l_player_choice_menu_00122
   796                          l_player_choice_menu_00119:
   797  0280  cb40              	bit	0, b
   798  0282  ca9501            	jp	Z, l_player_choice_menu_00120
   799                          l_player_choice_menu_00122:
   800                          ;menu_player_choice.c:100: if (input == MENU_KEY_BACK)
   801  0285  c5                	push	bc
   802  0286  3e01              	ld	a,0x01
   803  0288  f5                	push	af
   804  0289  33                	inc	sp
   805  028a  cd0000            	call	_sfx_play_sync
   806  028d  33                	inc	sp
   807  028e  c1                	pop	bc
   808                          ;menu_player_choice.c:102: clear_tilemap();
   809  028f  78                	ld	a, b
   810  0290  b7                	or	a, a
   811  0291  281c              	jr	Z,l_player_choice_menu_00124
   812                          ;menu_player_choice.c:104: load_layer2_screen(LY2_INTRO_SCREEN);
   813  0293  cd0000            	call	_clear_tilemap
   814                          ;menu_player_choice.c:105: return -1;
   815  0296  3e01              	ld	a,0x01
   816  0298  f5                	push	af
   817  0299  33                	inc	sp
   818  029a  cd0000            	call	_select_tilemap
   819  029d  33                	inc	sp
   820                          ;menu_player_choice.c:106: }
   821  029e  215bc6            	ld	hl,0xc65b
   822  02a1  e5                	push	hl
   823  02a2  3e4a              	ld	a,0x4a
   824  02a4  f5                	push	af
   825  02a5  33                	inc	sp
   826  02a6  cd0000            	call	_load_layer2_screen
   827  02a9  f1                	pop	af
   828  02aa  33                	inc	sp
   829                          ;menu_player_choice.c:107: else
   830  02ab  2eff              	ld	l,0xff
   831  02ad  1806              	jr	l_player_choice_menu_00126
   832                          l_player_choice_menu_00124:
   833                          ;menu_player_choice.c:111: }
   834  02af  211a00            	ld	hl, +(_game_settings + 26)
   835  02b2  71                	ld	(hl), c
   836                          ;menu_player_choice.c:112: }
   837  02b3  2e00              	ld	l,0x00
   838                          l_player_choice_menu_00126:
   839                          ;menu_player_choice.c:114: ERROR: no line number 114 in file menu_player_choice.c
   840  02b5  ddf9              	ld	sp, ix
   841  02b7  dde1              	pop	ix
   842  02b9  c9                	ret
   843                          	SECTION IGNORE
   844                          
