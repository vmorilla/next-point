/tmp/tmpS1VchsaU.asm:
     1                          MODULE sprites_asm
     2                          LINE 0, "sprites.asm"
sprites.asm:
                                
     1                          SECTION code_user
     2                          
     3                          PUBLIC _upload_sprite_attrs, _hide_sprites
     4                          
     5                              ; void upload_sprite_attrs(uint8_t index, uint8_t length, SpritePattern pattern[]);
     6                          _upload_sprite_attrs:
     7  0000  e1                    pop hl
     8  0001  d1                    pop de ; e = index, d = length
     9  0002  e3                    ex (sp), hl ; hl = pattern address
    10                          
    11                              ; Selects the index of the sprite to upload in the port
    12  0003  013b30                ld bc, 0x303B
    13  0006  f3                    di
    14  0007  ed59                  out (c), e
    15                          
    16                              ; Upload port
    17  0009  0e57                  ld c, 0x57
    18                              ; B set to 5 (size of sprite attrs), C to the sprite attribute upload port
    19                          next_sprite:
    20  000b  0605                  ld b, 5
    21  000d  edb3                  otir
    22  000f  15                    dec d
    23  0010  20f9                  jr nz, next_sprite
    24  0012  fb                    ei
    25  0013  c9                    ret
    26                          
    27                          _hide_sprites:
    28  0014  e1                    pop hl
    29  0015  e3                    ex (sp), hl
    30                              ; h = size, l = attr index
    31  0016  44                    ld b, h
    32  0017  7d                    ld a, l
    33  0018  ed9234                NEXTREG 0x34, a
    34  001b  3e40                  ld a, 0b01000000
    35                          next:
    36  001d  ed9278                NEXTREG 0x78, a
    37  0020  10fb                  djnz next
    38  0022  c9                    ret
    39                          
